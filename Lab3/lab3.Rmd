---
title: "Лабораторная работа 3"
author: "Сопова Екатерина, РИ-450004"
date: '10 октября 2018 г '
output: html_document
---
## Исходные данные
Файл forbes.htm содержит список богатейших американцев по версии журнала Форбс.
На его примере потренируемся в разборе html страниц.

### Задание 1
1. Используйте команду readLines для загрузки файла в текстовый вектор html.
```{r}
forbes<-readLines("forbes.htm" )
```

  1) Сколько строк в файле?
```{r}
length(forbes)
```

  2) Сколько символов в файле?
```{r}
sum(nchar(forbes))
```

   
2. Откройте файл в текстовом редакторе. Найдите строки, содержащие данные о Билле Гейтсе и Ларри Эллисоне и запомните размер их дохода.
Билл Гейтс - $72B
Ларри Эллисон - $41B

3. Напишите шаблон регулярного выражения и используйте функцию grep, чтобы извлечь размер дохода из данных в векторе html.
Удостоверьтесь, что полученный вектор номеров строк содержит содержит ровно 100 записей и ссылается на номера строк в котрых действительно есть информация о доходе, а не просто первый попавшийся текст.
```{r}
worth<-grep(pattern="[$](\\d+,*\\d*) B" ,forbes)
forbes[worth]
length(worth)
```

4. Напишите код, использовав регулярное выражение из п. 3, и функции regexp и regmatches, чтобы извлечь все данные о доходе.
```{r}
worth.money<-regmatches(forbes, regexpr("[$](\\d+,*\\d*) B", forbes))
worth.money
```

Проверьте следующее:
   1. Должно быть ровно сто значений.
```{r}
length(worth.money)
```
   
   2. Самый большой доход должен быть доход Билла Гейтса
```{r}
worth.money[1]
```
   
   3. Такой доход должен быть в списке один раз.
```{r}
length(worth.money[worth.money=="$72 B"])
```
   
   4. В всписке должна быть цифра, которую мы запомнили для Ларри Эллисона.
```{r}
length(worth.money[worth.money=="$41 B"])
```

   5. Должно быть как минимум два значения, встречающихся несколько раз.
```{r}
length(worth.money[worth.money=="$4,6 B"])
length(worth.money[worth.money=="$36 B"])
100 - length(unique(worth.money)) - length(worth.money[worth.money=="$36 B"]) - length(worth.money[worth.money=="$4,6 B"])
```

Как видно в списке есть минимум 2 значения, которые посторются первое значение 2 раза, а второе три раза. А так же в списке присутствуют еще 29 значений, которые могут повторятся.

### Задание 2
5. В данных доход представлен в формате **"$42 B"**, что означает **42 × 10^9**.
Преобразуйте этот формат в числовой и сохраните в вектор worths. 
```{r}
worths<-as.numeric(sub(",",".", regmatches(worth.money, regexpr('(\\d+,*\\d*)',worth.money))))*10^9 
worths
```

Удостоверьтесь в следующем:
   1. worths является вектором и в нём сто занчений типа double.
```{r}
is.vector(worths)
typeof(worths)
```
   
   2. Все элементы вектора worths больше 1 миллиарда.
```{r}
length(worths[worths>10^9])
```
   
   3. Самое большое число это доход Билла Гейтса.
```{r}
max(worths)
```
   
   
6. Используйте вектор worths, чтобы выяснить следующее:
   1. Какова медиана ста этих записей?
```{r}
median(worths)
```
   
   2. Средний доход?
```{r}
mean(worths)
```
   
   3. Как много людей из этого списка имеют доход больше 5млрд., 10, 25? 
```{r}
length(worths[worths>5*10^9])
length(worths[worths>10^10])
length(worths[worths>25*10^9])
```
   
   4. Какой их общий доход?
```{r}
sum(worths)
```
   
   5. Какую долю от общего дохода, составляет пятёрка самых богатых.
```{r}
sum(worths[1:5])/sum(worths)
```
   
   6. Какую долю от общего дохода, составляют 20 самых богатых.
```{r}
sum(worths[1:20])/sum(worths)
```
   
   7. В данных [федерального резерва США] (https://www.federalreserve.gov/releases/z1/current/html/introductory_text.htm) найдите показатель дохода всех домохозяйств (Household net worth) в соответвующем году, какую долю общего дохода составляют 100 богатейших людей. 
```{r}
household.2013 <- 83.280*10^9
household.2013/sum(worths)
```